(function(e){function s(e){return new RegExp("^"+e+"$")}function o(e,t){var n=Array.prototype.slice.call(arguments,2);var r=e.split(".");var i=r.pop();for(var s=0;s<r.length;s++){t=t[r[s]]}return t[i].apply(t,n)}var t=[];var n={options:{prependExistingHelpBlock:false,sniffHtml:true,preventSubmit:true,submitError:false,submitSuccess:false,semanticallyStrict:false,bindEvents:[],autoAdd:{helpBlocks:true},filter:function(){return true}},methods:{init:function(s){var o=e.extend(true,{},n);o.options=e.extend(true,o.options,s);var u=this;var a=e.unique(u.map(function(){return e(this).parents("form")[0]}).toArray());e(a).bind("submit.validationSubmit",function(t){var n=e(this);var r=0;var i=n.find("input,textarea,select").not("[type=submit],[type=image]").filter(o.options.filter);var s=n.find(".control-group");var u=i.filter(function(){return e(this).triggerHandler("getValidatorCount.validation")>0});u.trigger("submit.validation");i.trigger("validationLostFocus.validation");s.each(function(t,n){var i=e(n);if(i.hasClass("warning")||i.hasClass("error")){i.removeClass("warning").addClass("error");r++}});if(r){if(o.options.preventSubmit){t.preventDefault();t.stopImmediatePropagation()}n.addClass("error");if(e.isFunction(o.options.submitError)){o.options.submitError(n,t,u.jqBootstrapValidation("collectErrors",true))}}else{n.removeClass("error");if(e.isFunction(o.options.submitSuccess)){o.options.submitSuccess(n,t)}}});return this.each(function(){var n=e(this),s=n.parents(".control-group").first(),u=s.find(".help-block").first(),a=n.parents("form").first(),f=[];if(!u.length&&o.options.autoAdd&&o.options.autoAdd.helpBlocks){u=e('<div class="help-block" />');s.find(".controls").append(u);t.push(u[0])}if(o.options.sniffHtml){var l;if(n.data("validationPatternPattern")){n.attr("pattern",n.data("validationPatternPattern"))}if(n.attr("pattern")!==undefined){l="Not in the expected format<!-- data-validation-pattern-message to override -->";if(n.data("validationPatternMessage")){l=n.data("validationPatternMessage")}n.data("validationPatternMessage",l);n.data("validationPatternRegex",n.attr("pattern"))}if(n.attr("max")!==undefined||n.attr("aria-valuemax")!==undefined){var c=n.attr("max")!==undefined?n.attr("max"):n.attr("aria-valuemax");l="Too high: Maximum of '"+c+"'<!-- data-validation-max-message to override -->";if(n.data("validationMaxMessage")){l=n.data("validationMaxMessage")}n.data("validationMaxMessage",l);n.data("validationMaxMax",c)}if(n.attr("min")!==undefined||n.attr("aria-valuemin")!==undefined){var h=n.attr("min")!==undefined?n.attr("min"):n.attr("aria-valuemin");l="Too low: Minimum of '"+h+"'<!-- data-validation-min-message to override -->";if(n.data("validationMinMessage")){l=n.data("validationMinMessage")}n.data("validationMinMessage",l);n.data("validationMinMin",h)}if(n.attr("maxlength")!==undefined){l="Too long: Maximum of '"+n.attr("maxlength")+"' characters<!-- data-validation-maxlength-message to override -->";if(n.data("validationMaxlengthMessage")){l=n.data("validationMaxlengthMessage")}n.data("validationMaxlengthMessage",l);n.data("validationMaxlengthMaxlength",n.attr("maxlength"))}if(n.attr("minlength")!==undefined){l="Too short: Minimum of '"+n.attr("minlength")+"' characters<!-- data-validation-minlength-message to override -->";if(n.data("validationMinlengthMessage")){l=n.data("validationMinlengthMessage")}n.data("validationMinlengthMessage",l);n.data("validationMinlengthMinlength",n.attr("minlength"))}if(n.attr("required")!==undefined||n.attr("aria-required")!==undefined){l=o.builtInValidators.required.message;if(n.data("validationRequiredMessage")){l=n.data("validationRequiredMessage")}n.data("validationRequiredMessage",l)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="number"){l=o.validatorTypes.number.message;if(n.data("validationNumberMessage")){l=n.data("validationNumberMessage")}n.data("validationNumberMessage",l);var p=o.validatorTypes.number.step;if(n.data("validationNumberStep")){p=n.data("validationNumberStep")}n.data("validationNumberStep",p);var d=o.validatorTypes.number.decimal;if(n.data("validationNumberDecimal")){d=n.data("validationNumberDecimal")}n.data("validationNumberDecimal",d)}if(n.attr("type")!==undefined&&n.attr("type").toLowerCase()==="email"){l="Not a valid email address<!-- data-validation-email-message to override -->";if(n.data("validationEmailMessage")){l=n.data("validationEmailMessage")}n.data("validationEmailMessage",l)}if(n.attr("minchecked")!==undefined){l="Not enough options checked; Minimum of '"+n.attr("minchecked")+"' required<!-- data-validation-minchecked-message to override -->";if(n.data("validationMincheckedMessage")){l=n.data("validationMincheckedMessage")}n.data("validationMincheckedMessage",l);n.data("validationMincheckedMinchecked",n.attr("minchecked"))}if(n.attr("maxchecked")!==undefined){l="Too many options checked; Maximum of '"+n.attr("maxchecked")+"' required<!-- data-validation-maxchecked-message to override -->";if(n.data("validationMaxcheckedMessage")){l=n.data("validationMaxcheckedMessage")}n.data("validationMaxcheckedMessage",l);n.data("validationMaxcheckedMaxchecked",n.attr("maxchecked"))}}if(n.data("validation")!==undefined){f=n.data("validation").split(",")}e.each(n.data(),function(e,t){var n=e.replace(/([A-Z])/g,",$1").split(",");if(n[0]==="validation"&&n[1]){f.push(n[1])}});var v=f;var m=[];var g=function(e,t){f[e]=r(t)};var y=function(t,i){if(n.data("validation"+i+"Shortcut")!==undefined){e.each(n.data("validation"+i+"Shortcut").split(","),function(e,t){m.push(t)})}else if(o.builtInValidators[i.toLowerCase()]){var s=o.builtInValidators[i.toLowerCase()];if(s.type.toLowerCase()==="shortcut"){e.each(s.shortcut.split(","),function(e,t){t=r(t);m.push(t);f.push(t)})}}};do{e.each(f,g);f=e.unique(f);m=[];e.each(v,y);v=m}while(v.length>0);var b={};e.each(f,function(t,i){var s=n.data("validation"+i+"Message");var u=!!s;var a=false;if(!s){s="'"+i+"' validation failed <!-- Add attribute 'data-validation-"+i.toLowerCase()+"-message' to input to change this message -->"}e.each(o.validatorTypes,function(t,o){if(b[t]===undefined){b[t]=[]}if(!a&&n.data("validation"+i+r(o.name))!==undefined){var f=o.init(n,i);if(u){f.message=s}b[t].push(e.extend(true,{name:r(o.name),message:s},f));a=true}});if(!a&&o.builtInValidators[i.toLowerCase()]){var f=e.extend(true,{},o.builtInValidators[i.toLowerCase()]);if(u){f.message=s}var l=f.type.toLowerCase();if(l==="shortcut"){a=true}else{e.each(o.validatorTypes,function(t,s){if(b[t]===undefined){b[t]=[]}if(!a&&l===t.toLowerCase()){n.data("validation"+i+r(s.name),f[s.name.toLowerCase()]);b[l].push(e.extend(f,s.init(n,i)));a=true}})}}if(!a){e.error("Cannot find validation info for '"+i+"'")}});u.data("original-contents",u.data("original-contents")?u.data("original-contents"):u.html());u.data("original-role",u.data("original-role")?u.data("original-role"):u.attr("role"));s.data("original-classes",s.data("original-clases")?s.data("original-classes"):s.attr("class"));n.data("original-aria-invalid",n.data("original-aria-invalid")?n.data("original-aria-invalid"):n.attr("aria-invalid"));n.bind("validation.validation",function(t,r){var s=i(n);var u=[];e.each(b,function(t,i){if(s||s.length||r&&r.includeEmpty||!!o.validatorTypes[t].includeEmpty||!!o.validatorTypes[t].blockSubmit&&r&&!!r.submitting){e.each(i,function(e,r){if(o.validatorTypes[t].validate(n,s,r)){u.push(r.message)}})}});return u});n.bind("getValidators.validation",function(){return b});var w=0;e.each(b,function(e,t){w+=t.length});n.bind("getValidatorCount.validation",function(){return w});n.bind("submit.validation",function(){return n.triggerHandler("change.validation",{submitting:true})});n.bind((o.options.bindEvents.length>0?o.options.bindEvents:["keyup","focus","blur","click","keydown","keypress","change"]).concat(["revalidate"]).join(".validation ")+".validation",function(t,r){var f=i(n);var l=[];if(r&&!!r.submitting){s.data("jqbvIsSubmitting",true)}else if(t.type!=="revalidate"){s.data("jqbvIsSubmitting",false)}var c=!!s.data("jqbvIsSubmitting");s.find("input,textarea,select").each(function(t,i){var s=l.length;e.each(e(i).triggerHandler("validation.validation",r),function(e,t){l.push(t)});if(l.length>s){e(i).attr("aria-invalid","true")}else{var o=n.data("original-aria-invalid");e(i).attr("aria-invalid",o!==undefined?o:false)}});a.find("input,select,textarea").not(n).not('[name="'+n.attr("name")+'"]').trigger("validationLostFocus.validation");l=e.unique(l.sort());if(l.length){s.removeClass("success error warning").addClass(c?"error":"warning");if(o.options.semanticallyStrict&&l.length===1){u.html(l[0]+(o.options.prependExistingHelpBlock?u.data("original-contents"):""))}else{u.html('<ul role="alert"><li>'+l.join("</li><li>")+"</li></ul>"+(o.options.prependExistingHelpBlock?u.data("original-contents"):""))}}else{s.removeClass("warning error success");if(f.length>0){s.addClass("success")}u.html(u.data("original-contents"))}if(t.type==="blur"){s.removeClass("success")}});n.bind("validationLostFocus.validation",function(){s.removeClass("success")})})},destroy:function(){return this.each(function(){var n=e(this),r=n.parents(".control-group").first(),i=r.find(".help-block").first(),s=n.parents("form").first();n.unbind(".validation");s.unbind(".validationSubmit");i.html(i.data("original-contents"));r.attr("class",r.data("original-classes"));n.attr("aria-invalid",n.data("original-aria-invalid"));i.attr("role",n.data("original-role"));if(e.inArray(i[0],t)>-1){i.remove()}})},collectErrors:function(t){var n={};this.each(function(t,r){var i=e(r);var s=i.attr("name");var o=i.triggerHandler("validation.validation",{includeEmpty:true});n[s]=e.extend(true,o,n[s])});e.each(n,function(e,t){if(t.length===0){delete n[e]}});return n},hasErrors:function(){var t=[];this.find("input,select,textarea").add(this).each(function(n,r){t=t.concat(e(r).triggerHandler("getValidators.validation")?e(r).triggerHandler("validation.validation",{submitting:true}):[])});return t.length>0},override:function(t){n=e.extend(true,n,t)}},validatorTypes:{callback:{name:"callback",init:function(e,t){var n={validatorName:t,callback:e.data("validation"+t+"Callback"),lastValue:e.val(),lastValid:true,lastFinished:true};var r="Not valid";if(e.data("validation"+t+"Message")){r=e.data("validation"+t+"Message")}n.message=r;return n},validate:function(e,t,n){if(n.lastValue===t&&n.lastFinished){return!n.lastValid}if(n.lastFinished===true){n.lastValue=t;n.lastValid=true;n.lastFinished=false;var r=n;var i=e;o(n.callback,window,e,t,function(t){if(r.lastValue===t.value){r.lastValid=t.valid;if(t.message){r.message=t.message}r.lastFinished=true;i.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){if(!e.is(":focus")&&e.parents("form").first().data("jqbvIsSubmitting")){i.trigger("blur.validation")}else{i.trigger("revalidate.validation")}},1)}})}return false}},ajax:{name:"ajax",init:function(e,t){return{validatorName:t,url:e.data("validation"+t+"Ajax"),lastValue:e.val(),lastValid:true,lastFinished:true}},validate:function(t,n,r){if(""+r.lastValue===""+n&&r.lastFinished===true){return r.lastValid===false}if(r.lastFinished===true){r.lastValue=n;r.lastValid=true;r.lastFinished=false;e.ajax({url:r.url,data:"value="+encodeURIComponent(n)+"&field="+t.attr("name"),dataType:"json",success:function(e){if(""+r.lastValue===""+e.value){r.lastValid=!!e.valid;if(e.message){r.message=e.message}r.lastFinished=true;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("revalidate.validation")},1)}},failure:function(){r.lastValid=true;r.message="ajax call failed";r.lastFinished=true;t.data("validation"+r.validatorName+"Message",r.message);setTimeout(function(){t.trigger("revalidate.validation")},1)}})}return false}},regex:{name:"regex",init:function(t,n){var r={};var i=t.data("validation"+n+"Regex");r.regex=s(i);if(i===undefined){e.error("Can't find regex for '"+n+"' validator on '"+t.attr("name")+"'")}var o="Not in the expected format";if(t.data("validation"+n+"Message")){o=t.data("validation"+n+"Message")}r.message=o;r.originalName=n;return r},validate:function(e,t,n){return!n.regex.test(t)&&!n.negative||n.regex.test(t)&&n.negative}},email:{name:"email",init:function(e,t){var n={};n.regex=s("[a-zA-Z0-9.!#$%&’*+/=?^_`{|}~-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,4}");var r="Not a valid email address";if(e.data("validation"+t+"Message")){r=e.data("validation"+t+"Message")}n.message=r;n.originalName=t;return n},validate:function(e,t,n){return!n.regex.test(t)&&!n.negative||n.regex.test(t)&&n.negative}},required:{name:"required",init:function(e,t){var n="This is required";if(e.data("validation"+t+"Message")){n=e.data("validation"+t+"Message")}return{message:n,includeEmpty:true}},validate:function(e,t,n){return!!(t.length===0&&!n.negative||t.length>0&&n.negative)},blockSubmit:true},match:{name:"match",init:function(t,n){var r=t.data("validation"+n+"Match");var i=t.parents("form").first();var s=i.find('[name="'+r+'"]').first();s.bind("validation.validation",function(){t.trigger("revalidate.validation",{submitting:true})});var o={};o.element=s;if(s.length===0){e.error("Can't find field '"+r+"' to match '"+t.attr("name")+"' against in '"+n+"' validator")}var u="Must match";var a=null;if((a=i.find('label[for="'+r+'"]')).length){u+=" '"+a.text()+"'"}else if((a=s.parents(".control-group").first().find("label")).length){u+=" '"+a.first().text()+"'"}if(t.data("validation"+n+"Message")){u=t.data("validation"+n+"Message")}o.message=u;return o},validate:function(e,t,n){return t!==n.element.val()&&!n.negative||t===n.element.val()&&n.negative},blockSubmit:true,includeEmpty:true},max:{name:"max",init:function(e,t){var n={};n.max=e.data("validation"+t+"Max");n.message="Too high: Maximum of '"+n.max+"'";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return parseFloat(t,10)>parseFloat(n.max,10)&&!n.negative||parseFloat(t,10)<=parseFloat(n.max,10)&&n.negative}},min:{name:"min",init:function(e,t){var n={};n.min=e.data("validation"+t+"Min");n.message="Too low: Minimum of '"+n.min+"'";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return parseFloat(t)<parseFloat(n.min)&&!n.negative||parseFloat(t)>=parseFloat(n.min)&&n.negative}},maxlength:{name:"maxlength",init:function(e,t){var n={};n.maxlength=e.data("validation"+t+"Maxlength");n.message="Too long: Maximum of '"+n.maxlength+"' characters";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return t.length>n.maxlength&&!n.negative||t.length<=n.maxlength&&n.negative}},minlength:{name:"minlength",init:function(e,t){var n={};n.minlength=e.data("validation"+t+"Minlength");n.message="Too short: Minimum of '"+n.minlength+"' characters";if(e.data("validation"+t+"Message")){n.message=e.data("validation"+t+"Message")}return n},validate:function(e,t,n){return t.length<n.minlength&&!n.negative||t.length>=n.minlength&&n.negative}},maxchecked:{name:"maxchecked",init:function(e,t){var n={};var r=e.parents("form").first().find('[name="'+e.attr("name")+'"]');r.bind("change.validation click.validation",function(){e.trigger("revalidate.validation",{includeEmpty:true})});n.elements=r;n.maxchecked=e.data("validation"+t+"Maxchecked");var i="Too many: Max '"+n.maxchecked+"' checked";if(e.data("validation"+t+"Message")){i=e.data("validation"+t+"Message")}n.message=i;return n},validate:function(e,t,n){return n.elements.filter(":checked").length>n.maxchecked&&!n.negative||n.elements.filter(":checked").length<=n.maxchecked&&n.negative},blockSubmit:true},minchecked:{name:"minchecked",init:function(e,t){var n={};var r=e.parents("form").first().find('[name="'+e.attr("name")+'"]');r.bind("change.validation click.validation",function(){e.trigger("revalidate.validation",{includeEmpty:true})});n.elements=r;n.minchecked=e.data("validation"+t+"Minchecked");var i="Too few: Min '"+n.minchecked+"' checked";if(e.data("validation"+t+"Message")){i=e.data("validation"+t+"Message")}n.message=i;return n},validate:function(e,t,n){return n.elements.filter(":checked").length<n.minchecked&&!n.negative||n.elements.filter(":checked").length>=n.minchecked&&n.negative},blockSubmit:true,includeEmpty:true},number:{name:"number",init:function(e,t){var n={};n.step=1;if(e.attr("step")){n.step=e.attr("step")}if(e.data("validation"+t+"Step")){n.step=e.data("validation"+t+"Step")}n.decimal=".";if(e.data("validation"+t+"Decimal")){n.decimal=e.data("validation"+t+"Decimal")}n.thousands="";if(e.data("validation"+t+"Thousands")){n.thousands=e.data("validation"+t+"Thousands")}n.regex=s("([+-]?\\d+(\\"+n.decimal+"\\d+)?)?");n.message="Must be a number";var r=e.data("validation"+t+"Message");if(r){n.message=r}return n},validate:function(e,t,n){var r=t.replace(n.decimal,".").replace(n.thousands,"");var i=parseFloat(r);var s=parseFloat(n.step);while(s%1!==0){s=parseFloat(s.toPrecision(12))*10;i=parseFloat(i.toPrecision(12))*10}var o=n.regex.test(t);var u=parseFloat(i)%parseFloat(s)===0;var a=!isNaN(parseFloat(r))&&isFinite(r);var f=!(o&&u&&a);return f},message:"Must be a number"}},builtInValidators:{email:{name:"Email",type:"email"},passwordagain:{name:"Passwordagain",type:"match",match:"password",message:"Does not match the given password<!-- data-validator-paswordagain-message to override -->"},positive:{name:"Positive",type:"shortcut",shortcut:"number,positivenumber"},negative:{name:"Negative",type:"shortcut",shortcut:"number,negativenumber"},integer:{name:"Integer",type:"regex",regex:"[+-]?\\d+",message:"No decimal places allowed<!-- data-validator-integer-message to override -->"},positivenumber:{name:"Positivenumber",type:"min",min:0,message:"Must be a positive number<!-- data-validator-positivenumber-message to override -->"},negativenumber:{name:"Negativenumber",type:"max",max:0,message:"Must be a negative number<!-- data-validator-negativenumber-message to override -->"},required:{name:"Required",type:"required",message:"This is required<!-- data-validator-required-message to override -->"},checkone:{name:"Checkone",type:"minchecked",minchecked:1,message:"Check at least one option<!-- data-validation-checkone-message to override -->"},number:{name:"Number",type:"number",decimal:".",step:"1"},pattern:{name:"Pattern",type:"regex",message:"Not in expected format"}}};var r=function(e){return e.toLowerCase().replace(/(^|\s)([a-z])/g,function(e,t,n){return t+n.toUpperCase()})};var i=function(t){var n=null;var r=t.attr("type");if(r==="checkbox"){n=t.is(":checked")?n:"";var i=t.parents("form").first()||t.parents(".control-group").first();if(i){n=i.find("input[name='"+t.attr("name")+"']:checked").map(function(t,n){return e(n).val()}).toArray().join(",")}}else if(r==="radio"){n=e('input[name="'+t.attr("name")+'"]:checked').length>0?t.val():"";var s=t.parents("form").first()||t.parents(".control-group").first();if(s){n=s.find("input[name='"+t.attr("name")+"']:checked").map(function(t,n){return e(n).val()}).toArray().join(",")}}else{n=t.val()}return n};e.fn.jqBootstrapValidation=function(t){if(n.methods[t]){return n.methods[t].apply(this,Array.prototype.slice.call(arguments,1))}else if(typeof t==="object"||!t){return n.methods.init.apply(this,arguments)}else{e.error("Method "+t+" does not exist on jQuery.jqBootstrapValidation");return null}};e.jqBootstrapValidation=function(t){e(":input").not("[type=image],[type=submit]").jqBootstrapValidation.apply(this,arguments)}})(jQuery)